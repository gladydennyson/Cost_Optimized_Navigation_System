<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Direction with search box</title>
    <style>
    #map-canvas{
        width: 400px;
        height: 400px;
    }
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    </head>
    <body>
    <div id="googleMap" style="width:100%; height:600px;"></div>
    <div>
    <input  type="text" id="mapsearch">
    <button id="myBtn">Find Direction</button>

   </div>
    <script>
         function detectBrowser() {
            var useragent = navigator.userAgent;
            var mapdiv = document.getElementById("googleMap");

            if (useragent.indexOf('iPhone') != -1 || useragent.indexOf('Android') != -1) {
                mapdiv.style.width = '100%';
                mapdiv.style.height = '100%';
            } else {
                mapdiv.style.width = '600px';
                mapdiv.style.height = '800px';
            }
        }

      var pos,end;

      function initMap() {
        var myLatLng = {lat: -25.363, lng: 131.044};

        var map = new google.maps.Map(document.getElementById('googleMap'), {
          zoom: 12,
          center: myLatLng
        });


        var searchBox = new google.maps.places.SearchBox(document.getElementById('mapsearch'));
        var directionsService = new google.maps.DirectionsService;
        var directionsDisplay = new google.maps.DirectionsRenderer;

            // var input = document.getElementById('pac-input');
           
            //call renderer to display directions
            directionsDisplay.setMap(map);


        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
             pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

          var marker = new google.maps.Marker({
          position: pos,
          map: map,
          title: 'Hello World!'
        });
           
            map.setCenter(pos);
          }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
          });
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }




        var onChangeHandler = function() {
             var locations = searchBox.getPlaces();
             end = locations[0].place_id;
            
             var marker = new google.maps.Marker({
             position: locations[0].geometry.location,
             map: map,
             title: locations[0].name
            });
           }






        google.maps.event.addListener(searchBox, 'places_changed', onChangeHandler);

        /* var markers = [
              
                ['imperial oversees', 19.091584, 72.837677],
               
            ];
            var position = new google.maps.LatLng(markers[0][1], markers[0][2]);
             marker = new google.maps.Marker({
                    position: position,
                    map: map,
                    
                });
          */

          document.getElementById("myBtn").addEventListener("click", function(){
          directionsService.route({

                        // origin: document.getElementById('start').value,
                        origin: pos,

                        // destination: marker.getPosition(),
                        destination: {
                          //position

                          placeId:end
                        },

                        travelMode: 'WALKING'
                    }, function(response, status) {
                        if (status === 'OK') {
                            //console.log(document.getElementById("mapsearch").value)

                            directionsDisplay.setDirections(response);
                        } else {
                            window.alert('Directions request failed due to ' + status);
                        }
                    });
          });


      }
    </script>

    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCHcxLjgimvHlg5HFEwep9bPx7tfoaZPvk&libraries=places&callback=initMap">
    </script>
  </body>
</html>
